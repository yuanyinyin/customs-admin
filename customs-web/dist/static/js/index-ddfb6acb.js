import{d as e,p as a,l as t,u as l,r as i,a as n,g as o,j as d,f as r,w as s,i as p,ag as u,b as c,Q as h,R as m,k as f,y as v,K as w,J as y,E as g}from"./vendor-78a6dd30.js";import b from"./dialogMenu-2bf6a19d.js";import{m as _,n as k,o as C,p as x}from"./index-30d780dc.js";import{p as V}from"./dateTime-1b081a2f.js";const j={class:"menu-container scroll-y p"},M={class:"filter-item m"},T=w("新增"),z={key:0},A={key:1},B=w("目录"),E=w("菜单"),H=w("按钮"),S=w("编辑"),U=w("删除"),J=e({setup(e){const J=a(null);t((()=>{D()}));const K=a({});let L=a({}),Q=a({});const R=()=>{K.value={show:!0,title:"新增菜单",option:"add"},L.value={type:1,hidden:1,pid:"",icon:"",path:"",title:"",sort:"",name:"",component:"",permissions:"",noCache:"0"}},q=l(),D=()=>{q.dispatch("menu/getMenu").then((e=>{J.value=e})).catch((e=>{}))};function F(){let e=L._rawValue;var a=e.pid;e.pid=a[a.length-1],k(e).then((e=>{K.value.show=!1,g({message:"新增成功！",type:"success"}),0!==L.value.pid?(C({pid:L.value.pid}).then((e=>{})),D()):D()}))}function G(){if(L.value.id===L.value.pid)return g({message:"自己不能成为自己的下级！",type:"error"}),!1;let e=L._rawValue;var a=e.pid;e.pid=a instanceof Array?a[a.length-1]:a,x(L.value.id,e).then((e=>{K.value.show=!1,g({message:"修改成功！",type:"success"}),0!==L.value.pid?(L.value.pid!==Q?C({pid:Q}).then((e=>{C({pid:L.value.pid}).then((e=>{}))})):C({pid:L.value.pid}).then((e=>{})),D()):D(),C({pid:L.value.pid}).then((e=>{}))}))}return(e,a)=>{const t=i("el-button"),l=i("el-table-column"),k=i("el-icon"),C=i("el-tag"),x=i("el-switch"),q=i("el-table"),I=i("el-card");return n(),o("div",j,[d("div",M,[r(t,{type:"primary",icon:p(u),onClick:R},{default:s((()=>[T])),_:1},8,["icon"])]),r(I,{class:"my-2"},{default:s((()=>[r(q,{ref:"table",data:J.value,style:{width:"100%"},"row-key":"id",load:e.getChildMenus,lazy:"",fit:"",border:"","highlight-current-row":"","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:s((()=>[r(l,{type:"index",label:"序号",width:"55"}),r(l,{prop:"title",label:"菜单标题",width:"165","show-overflow-tooltip":""}),r(l,{prop:"icon",label:"图标",align:"center",width:"70"},{default:s((e=>[r(k,{size:16},{default:s((()=>[(n(),c(h(p(m)[e.row.icon])))])),_:2},1024)])),_:1}),r(l,{prop:"sort",label:"排序",width:"70",align:"center"}),r(l,{prop:"component",label:"组件路径","show-overflow-tooltip":"",align:"center"},{default:s((e=>["Layout"==e.row.component?(n(),o("span",z)):(n(),o("span",A,f(null==e.row.component?"--":e.row.component),1))])),_:1}),r(l,{prop:"type",label:"菜单类型",align:"center",width:"80"},{default:s((e=>[1==e.row.type?(n(),c(C,{key:0,type:"success"},{default:s((()=>[B])),_:1})):v("v-if",!0),2==e.row.type?(n(),c(C,{key:1,type:"warning"},{default:s((()=>[E])),_:1})):v("v-if",!0),3==e.row.type?(n(),c(C,{key:2,type:"danger"},{default:s((()=>[H])),_:1})):v("v-if",!0)])),_:1}),r(l,{prop:"hidden",label:"是否可见",align:"center"},{default:s((e=>[r(x,{modelValue:e.row.hidden,"onUpdate:modelValue":a=>e.row.hidden=a,disabled:"","active-value":!1,"active-text":"是","inactive-value":!0,"inactive-text":"否"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),r(l,{prop:"date",label:"创建时间","show-overflow-tooltip":"",align:"center"},{default:s((e=>[w(f(p(V)(e.row.create_time)),1)])),_:1}),r(l,{label:"操作",width:"200",align:"center"},{default:s((e=>[r(t,{type:"primary",disabled:1==e.row.action,onClick:a=>{return t=e.row,K.value={show:!0,title:"修改菜单",option:"edit"},L.value={id:t.id,type:t.type,icon:t.icon,hidden:!0===t.hidden?"0":"1",title:t.title,path:t.path,sort:t.sort,name:t.name,component:t.component,pid:t.pid+"",permissions:t.permissions,noCache:0===t.noCache?"0":"1"},void(Q=t.pid);var t}},{default:s((()=>[S])),_:2},1032,["disabled","onClick"]),r(t,{type:"danger",disabled:1==e.row.action,onClick:a=>{return t=e.row,void y.confirm("此操作将永久删除该菜单，并删除所属子级, 是否继续?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{_(t.id).then((e=>{g({message:"删除成功",type:"success"}),D()}))})).catch((()=>{}));var t}},{default:s((()=>[U])),_:2},1032,["disabled","onClick"])])),_:1})])),_:1},8,["data","load"])])),_:1}),r(b,{"dialog-menu":K.value,"form-data":p(L),onHandleSubmitAdd:F,onHandleSubmitEdit:G},null,8,["dialog-menu","form-data"])])}}});export{J as default};
