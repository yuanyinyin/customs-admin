import{d as e,u as a,p as l,l as t,r as o,ah as n,a as s,g as i,y as r,j as u,f as d,w as c,ad as p,i as m,ai as v,ag as f,X as g,b as h,k as y,K as b,z as w,Y as C,J as _,E as k}from"./vendor-78a6dd30.js";import x from"./dialogRoles-bf8570b1.js";import z from"./dialogPermission-d11af581.js";import{w as V,x as j,y as K,z as N}from"./index-30d780dc.js";import{p as S}from"./dateTime-1b081a2f.js";const U={class:"roles-container scroll-y p"},P={class:"head-container m-1 mr-3 rowSS"},T={class:"filter-item"},R=b("查询"),B=b("新增"),E=u("div",{class:"clearfix"},[u("span",null,"角色列表")],-1),H=b(" 分配权限 "),A=b(" 编辑 "),G=b(" 删除 "),I={class:"block columnCC mt-2"},J=e({setup(e){const J=a(),L=l(null),X=l(null),Y=l({page:1,limit:10});t((()=>{W()}));const $=l({});let q=l({});const D=()=>{$.value={show:!0,title:"新增角色",option:"add"},q.value={title:""}},F=l({}),M=e=>{let a=F.value.option;j(a,{menuIds:e}).then((e=>{k({message:"分配成功！",type:"success"}),F.value.show=!1,W()}))};function O(){let e=q._rawValue;K(e).then((e=>{$.value.show=!1,k({message:"新增成功！",type:"success"}),W()}))}function Q(){N(q.value.id,q.value).then((e=>{$.value.show=!1,k({message:"编辑角色成功！",type:"success"}),W()}))}const W=()=>{J.dispatch("roles/getRolesList",Y._rawValue).then((e=>{L.value=e.items,X.value=e.total})).catch((e=>{}))},Z=()=>{Y.page=1,W()},ee=()=>{Y.page=1,W()};return(e,a)=>{const l=o("el-input"),t=o("el-form-item"),j=o("el-button"),K=o("el-form"),N=o("el-table-column"),J=o("el-button-group"),ae=o("el-table"),le=o("el-pagination"),te=o("el-card"),oe=n("loading");return s(),i("div",U,[r("工具栏"),u("div",P,[r(" 搜索 "),d(K,{inline:!0,model:Y.value,class:"demo-form-inline"},{default:c((()=>[d(t,{label:"角色名称"},{default:c((()=>[d(l,{modelValue:Y.value.roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>Y.value.roleName=e),placeholder:"角色名称",class:"filter-item",onKeyup:p(ee,["enter","native"]),clearable:""},null,8,["modelValue","onKeyup"])])),_:1}),d(t,{label:"角色编码"},{default:c((()=>[d(l,{modelValue:Y.value.roleCode,"onUpdate:modelValue":a[1]||(a[1]=e=>Y.value.roleCode=e),placeholder:"角色编码",class:"filter-item",onKeyup:p(ee,["enter","native"]),clearable:""},null,8,["modelValue","onKeyup"])])),_:1}),d(t,null,{default:c((()=>[u("span",T,[d(j,{type:"success",icon:m(v),onClick:ee},{default:c((()=>[R])),_:1},8,["icon"]),d(j,{type:"primary",icon:m(f),onClick:D},{default:c((()=>[B])),_:1},8,["icon"])])])),_:1})])),_:1},8,["model"])]),d(te,{class:"m-1"},{header:c((()=>[E])),default:c((()=>[g((s(),h(ae,{data:L.value,"onUpdate:data":a[2]||(a[2]=e=>L.value=e),stripe:"",style:{width:"100%"}},{default:c((()=>[d(N,{type:"index",label:"序号",align:"center",width:"55"},{default:c((e=>[u("span",null,y((Y.value.page-1)*Y.value.limit+e.$index+1),1)])),_:1}),d(N,{prop:"roleName",label:"角色名称",align:"center"}),d(N,{prop:"roleCode",label:"角色编码",align:"center"}),d(N,{prop:"date",label:"创建时间",align:"center"},{default:c((e=>[b(y(m(S)(e.row.createTime)),1)])),_:1}),d(N,{label:"操作",align:"center"},{default:c((e=>[d(J,null,{default:c((()=>[d(j,{type:"success",onClick:w((a=>{return l=e.row,void(F.value={show:!0,title:"分配菜单",option:l.id});var l}),["prevent"])},{default:c((()=>[H])),_:2},1032,["onClick"]),d(j,{type:"warning",onClick:w((a=>{return l=e.row,$.value={show:!0,title:"编辑角色",option:"edit"},void(q.value={id:l.id,roleName:l.roleName,roleCode:l.roleCode});var l}),["prevent"])},{default:c((()=>[A])),_:2},1032,["onClick"]),d(j,{type:"danger",onClick:w((a=>{return l=e.row,void _.confirm("此操作将永久删除该角色, 是否继续?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{V(l.id).then((e=>{k({message:"删除成功",type:"success"}),W()}))})).catch((()=>{}));var l}),["prevent"])},{default:c((()=>[G])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[oe,false]]),u("div",I,[g(d(le,{currentPage:Y.value.page,"onUpdate:currentPage":a[3]||(a[3]=e=>Y.value.page=e),"page-size":Y.value.limit,"onUpdate:page-size":a[4]||(a[4]=e=>Y.value.limit=e),"page-sizes":[10,25,50,100],layout:"total, sizes, prev, pager, next, jumper",total:X.value,onSizeChange:Z,onCurrentChange:W},null,8,["currentPage","page-size","total"]),[[C,X.value>0]])])])),_:1}),d(x,{"dialog-roles":$.value,"form-data":m(q),onHandleSubmitAdd:O,onHandleSubmitEdit:Q},null,8,["dialog-roles","form-data"]),d(z,{"permissions-dialog":F.value,ref:"menu",onGiveRules:M},null,8,["permissions-dialog"])])}}});export{J as default};
