import{d as e,p as a,r as l,a as o,g as t,f as d,w as i,j as u,b as r,y as s,X as p,F as n,h as m,i as f,ag as v,K as D,Y as b}from"./vendor-78a6dd30.js";import{g as h,j as g,q as c}from"./index-30d780dc.js";const V={class:"dialog-footer"},y=D("取 消"),w=D("确 定"),I=D("确 定"),_=e({props:{userDialog:{require:!0,default:null,type:Object},formData:{require:!0,default:null,type:Object}},emits:["userHandleSubmitAdd","userHandleSubmitEdit"],setup(e,{emit:D}){const _=e,k=a(!1),j=a([]),U=a({add:!1}),x=a("https://www.nteport.com/ycjAdmin"),P=a({authToken:h()}),q=a([]),C=a(""),H=a(!1),S=a(null),T=a({pointId:[{required:!0,message:"请选择地点",trigger:"blur"}]}),A=e=>{e?(k.value=!0,g({pointName:e}).then((e=>{k.value=!1,j.value=e.data}))):j.value=[]},E=(e,a,l)=>{_.formData.photoId?_.formData.photoId+=e.data+",":_.formData.photoId=e.data+","},F=e=>{C.value=e.url,H.value=!0},G=(e,a)=>{void 0===e.response?_.formData.photoId=_.formData.photoId.replace(e.name+",",""):_.formData.photoId=_.formData.photoId.replace(e.response.data+",","")},O=()=>{_.userDialog.show=!1,S.value.resetFields(),q.value=[],j.value=[]},B=()=>{if(_.formData.id&&(_.formData.pointId?c({Id:_.formData.pointId}).then((e=>{j.value.push({name:e.data.name,id:e.data.id})})):j.value=[],_.formData.photoId)){let a=_.formData.photoId.split(",");for(var e=0;e<a.length;e++)""!=a[e]&&q.value.push({name:a[e],url:x.value+"/file/downLoad/"+a[e]})}};return(a,h)=>{const g=l("el-form-item"),c=l("el-input"),J=l("el-option"),K=l("el-select"),L=l("el-icon"),M=l("el-upload"),N=l("el-image"),X=l("el-dialog"),Y=l("el-form"),z=l("el-button");return o(),t("div",null,[d(X,{modelValue:e.userDialog.show,"onUpdate:modelValue":h[8]||(h[8]=a=>e.userDialog.show=a),title:e.userDialog.title,width:"60%",center:"",onOpen:B,onClose:O},{footer:i((()=>[u("span",V,[d(z,{onClick:O},{default:i((()=>[y])),_:1}),"add"===e.userDialog.option?(o(),r(z,{key:0,type:"primary",disabled:U.value.add,onClick:h[6]||(h[6]=e=>{S.value.validate((e=>{if(!e)return!1;U.value.add=!0,"add"===_.userDialog.option&&D("userHandleSubmitAdd"),U.value.add=!1}))})},{default:i((()=>[w])),_:1},8,["disabled"])):s("v-if",!0),"edit"===e.userDialog.option?(o(),r(z,{key:1,type:"primary",onClick:h[7]||(h[7]=e=>{S.value.validate((e=>{if(!e)return!1;"edit"===_.userDialog.option&&D("userHandleSubmitEdit")}))})},{default:i((()=>[I])),_:1})):s("v-if",!0)])])),default:i((()=>[d(Y,{ref_key:"refUserForm",ref:S,model:e.formData,rules:T.value,"label-width":"80px"},{default:i((()=>["edit"===e.userDialog.option?p((o(),r(g,{key:0,label:"id",prop:"id"},null,512)),[[b,!1]]):s("v-if",!0),"detail"===e.userDialog.option?(o(),r(g,{key:1,label:"上报日期",prop:"reportTime"},{default:i((()=>[d(c,{modelValue:e.formData.reportTime,"onUpdate:modelValue":h[0]||(h[0]=a=>e.formData.reportTime=a),placeholder:"上报日期",disabled:"detail"==e.userDialog.option,style:{width:"300px"}},null,8,["modelValue","disabled"])])),_:1})):s("v-if",!0),d(g,{label:"事件地点",prop:"pointId"},{default:i((()=>[d(K,{disabled:"detail"==e.userDialog.option,style:{width:"300px"},modelValue:e.formData.pointId,"onUpdate:modelValue":h[1]||(h[1]=a=>e.formData.pointId=a),filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"请输入点位，搜索后选择","remote-method":A,loading:k.value},{default:i((()=>[(o(!0),t(n,null,m(j.value,(e=>(o(),r(J,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue","loading"])])),_:1}),d(g,{label:"现场图片",prop:"photoId"},{default:i((()=>[d(M,{action:x.value+"/file/upload?type=21","list-type":"picture-card",accept:".jpg,.jpeg,.png,.bmp,.JPG,.JPEG,.PBG,.BMP","on-success":E,"on-preview":F,"on-remove":G,"auto-upload":!0,headers:P.value,disabled:"detail"==e.userDialog.option,"file-list":q.value},{default:i((()=>[d(L,null,{default:i((()=>[d(f(v))])),_:1})])),_:1},8,["action","headers","disabled","file-list"])])),_:1}),d(X,{modelValue:H.value,"onUpdate:modelValue":h[2]||(h[2]=e=>H.value=e)},{default:i((()=>[d(N,{src:C.value,alt:"Preview Image"},null,8,["src"])])),_:1},8,["modelValue"]),d(g,{label:"具体情况",prop:"situation"},{default:i((()=>[d(c,{modelValue:e.formData.situation,"onUpdate:modelValue":h[3]||(h[3]=a=>e.formData.situation=a),placeholder:"详情",rows:10,type:"textarea",disabled:"detail"==e.userDialog.option},null,8,["modelValue","disabled"])])),_:1}),d(g,{label:"备注",prop:"memo"},{default:i((()=>[d(c,{modelValue:e.formData.memo,"onUpdate:modelValue":h[4]||(h[4]=a=>e.formData.memo=a),placeholder:"备注（最多100字）",disabled:"detail"==e.userDialog.option},null,8,["modelValue","disabled"])])),_:1}),d(g,{label:"处置情况",prop:"result"},{default:i((()=>[d(c,{modelValue:e.formData.result,"onUpdate:modelValue":h[5]||(h[5]=a=>e.formData.result=a),placeholder:"处置情况",disabled:"detail"==e.userDialog.option,"v-show":"add"!=e.userDialog.option},null,8,["modelValue","disabled","v-show"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{_ as default};
