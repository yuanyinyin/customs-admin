import{d as e,l as a,p as t,r as d,a as l,g as r,j as s,f as n,w as i,i as o,ag as p,k as c,b as u,z as m,y as f,K as h,J as g,E as v}from"./vendor-78a6dd30.js";import{g as w,d as y,a as I,u as b}from"./dept-5dd4a664.js";import{p as _}from"./dateTime-1b081a2f.js";import k from"./dialogDept-3496446a.js";import"./index-30d780dc.js";const x={class:"menu-container scroll-y p"},N={class:"filter-item m"},j=h("新增"),C=h("修改"),T=h(" 删除 "),z=e({setup(e){a((()=>{B()}));const h=t([]),z=t({});let A=t({});const B=()=>{w().then((e=>{h.value=e.data})).catch((e=>{}))},E=()=>{z.value={show:!0,title:"新增部门",option:"add"},A.value={parentId:"",deptName:"",orderNum:0}};function F(){let e=A._rawValue;var a=e.parentId;e.parentId=a[a.length-1],I(e).then((e=>{z.value.show=!1,v({message:"新增成功！",type:"success"}),B()}))}function H(){let e=A._rawValue;if(e.parentId==e.id)v({message:"自己不能成为自己的下级！",type:"error"});else{var a=e.parentId;e.parentId=a instanceof Array?a[a.length-1]:a,b(e).then((e=>{z.value.show=!1,v({message:"修改成功！",type:"success"}),B()}))}}return(e,a)=>{const t=d("el-button"),w=d("el-table-column"),I=d("el-table"),b=d("el-card");return l(),r("div",x,[s("div",N,[n(t,{type:"primary",icon:o(p),onClick:E},{default:i((()=>[j])),_:1},8,["icon"])]),n(b,{class:"my-2"},{default:i((()=>[n(I,{style:{width:"100%"},data:h.value,ref:"table","row-key":"id",lazy:"",fit:"","highlight-current-row":"","default-expand-all":"","tree-props":{children:"children"}},{default:i((()=>[n(w,{type:"index",label:"序号",width:"100"}),n(w,{prop:"id",label:"部门id"}),n(w,{prop:"deptName",label:"部门名称"}),n(w,{label:"创建时间",align:"center",prop:"createTime",width:"200"},{default:i((e=>[s("span",null,c(o(_)(e.row.createTime)),1)])),_:1}),n(w,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:i((e=>[n(t,{type:"warning",onClick:a=>{return t=e.row,z.value={show:!0,title:"修改菜单",option:"edit"},void(A.value={id:t.id,parentId:t.parentId,ancestors:t.ancestors,deptName:t.deptName,areaId:t.areaId,streetId:t.streetId,orderNum:t.orderNum,leaderId:t.leaderId,phone:t.phone,email:t.email,status:t.status,delFlag:t.delFlag});var t}},{default:i((()=>[C])),_:2},1032,["onClick"]),0!=e.row.parentId?(l(),u(t,{key:0,type:"danger",onClick:m((a=>{return t=e.row,void g.confirm("此操作将永久删除该部门及其所有子部门, 是否继续?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{y(t.id).then((e=>{v({message:"删除成功",type:"success"}),B()}))})).catch((()=>{}));var t}),["prevent"])},{default:i((()=>[T])),_:2},1032,["onClick"])):f("v-if",!0)])),_:1})])),_:1},8,["data"])])),_:1}),n(k,{"dialog-dept":z.value,"form-data":o(A),onHandleSubmitAdd:F,onHandleSubmitEdit:H},null,8,["dialog-dept","form-data"])])}}});export{z as default};
