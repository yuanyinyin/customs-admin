import{d as e,u as a,p as l,l as t,r as o,ah as r,a as i,g as n,j as s,y as u,f as p,w as d,i as c,ai as m,X as f,b as v,k as g,Y as w,K as h,E as y,J as b}from"./vendor-78a6dd30.js";import k from"./riskDialog-f216b313.js";import{g as _,a as C,u as x,d as T}from"./risk-af0d91d4.js";import"./index-30d780dc.js";const I={class:"LogContainer scroll-y"},j={class:"head-container m-1 mr-3 rowSS"},z={class:"filter-item"},S=h("查询"),U=s("div",{class:"clearfix"},[s("span",null,"隐患发现列表")],-1),Y={key:0},P={key:1,style:{color:"red"}},V={style:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}},D={key:0,style:{color:"red"}},A={key:1,style:{color:"green"}},B={style:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}},E={style:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}},H=h("查看详情"),M=h("编辑"),F=h("删除"),J={class:"block columnCC mt-2"},K=e({setup(e){a();const h=l(null),K=l(null),L=l({show:!1}),N=l({}),Q=l({page:1,limit:10});t((()=>{X()}));const X=()=>{_(Q._rawValue).then((e=>{h.value=e.data.items,K.value=e.data.total})).catch((e=>{}))},$=()=>{Q.page=1,X()};function q(){C(N.value).then((e=>{L.value.show=!1,y({message:"新增成功！",type:"success"}),X()}))}function G(){x(N.value.id,N.value).then((e=>{L.value.show=!1,y({message:"更新成功！",type:"success"}),X()}))}return(e,a)=>{const l=o("el-date-picker"),t=o("el-form-item"),_=o("el-button"),C=o("el-form"),x=o("el-table-column"),O=o("el-button-group"),R=o("el-table"),W=o("el-pagination"),Z=o("el-card"),ee=r("loading");return i(),n("div",I,[s("div",j,[u(" 查询工具条 "),p(C,{inline:!0,model:Q.value,class:"demo-form-inline"},{default:d((()=>[p(t,{label:"上报日期"},{default:d((()=>[u(' <el-input\r\n            v-model="listQuery.reportTime"\r\n            placeholder="发布日期"\r\n            class="filter-item"\r\n            @keyup.enter="handleFilter" clearable\r\n          /> '),p(l,{modelValue:Q.value.reportTime,"onUpdate:modelValue":a[0]||(a[0]=e=>Q.value.reportTime=e),placeholder:"上报日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),p(t,null,{default:d((()=>[s("span",z,[p(_,{type:"success",icon:c(m),onClick:$},{default:d((()=>[S])),_:1},8,["icon"]),u(' <el-button type="primary" :icon="Plus" @click="handleAdd">新增</el-button> ')])])),_:1})])),_:1},8,["model"])]),p(Z,{class:"m-1"},{header:d((()=>[U])),default:d((()=>[f((i(),v(R,{data:h.value,stripe:"",style:{width:"100%"}},{default:d((()=>[p(x,{fixed:"",type:"index",label:"序号",align:"center"},{default:d((e=>[s("span",null,g((Q.value.page-1)*Q.value.limit+e.$index+1),1)])),_:1}),p(x,{prop:"id",label:"编号",align:"center"}),p(x,{prop:"reportTime",label:"上报日期",align:"center"}),p(x,{prop:"type",label:"风险类别",align:"center"},{default:d((e=>[0==e.row.type?(i(),n("span",Y,"一般")):u("v-if",!0),1==e.row.type?(i(),n("span",P,"较大风险")):u("v-if",!0)])),_:1}),p(x,{prop:"situation",label:"具体情况",align:"center"},{default:d((e=>[s("span",V,g(e.row.situation),1)])),_:1}),p(x,{prop:"status",label:"处置结果",align:"center"},{default:d((e=>[0==e.row.status?(i(),n("span",D,"未处理")):u("v-if",!0),1==e.row.status?(i(),n("span",A,"已处理")):u("v-if",!0)])),_:1}),p(x,{prop:"result",label:"处置情况",align:"center"},{default:d((e=>[s("span",B,g(e.row.result),1)])),_:1}),p(x,{prop:"creatorName",label:"创建人",align:"center"}),p(x,{prop:"memo",label:"备注",align:"center"},{default:d((e=>[s("span",E,g(e.row.memo),1)])),_:1}),p(x,{label:"操作",align:"center","show-overflow-tooltip":"","min-width":"100%"},{default:d((e=>[p(O,null,{default:d((()=>[p(_,{type:"primary",onClick:a=>{return l=e.row,L.value={show:!0,title:"隐患发现详情",option:"detail"},void(N.value={id:l.id,reportTime:l.reportTime,pointId:l.pointId,photoId:l.photoId,situation:l.situation,type:l.type,result:l.result,memo:l.memo});var l}},{default:d((()=>[H])),_:2},1032,["onClick"]),p(_,{type:"warning",onClick:a=>{return l=e.row,L.value={show:!0,title:"修改隐患发现",option:"edit"},void(N.value={id:l.id,reportTime:l.reportTime,pointId:l.pointId,photoId:l.photoId,situation:l.situation,type:l.type,result:l.result,memo:l.memo});var l}},{default:d((()=>[M])),_:2},1032,["onClick"]),p(_,{type:"danger",onClick:a=>{return l=e.row,void b.confirm("是否确认删除该条数据, 是否继续?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{T(l.id).then((e=>{y({message:"删除成功！",type:"success"}),X()})).catch((e=>{}))})).catch((()=>{}));var l}},{default:d((()=>[F])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[ee,false]]),s("div",J,[f(p(W,{currentPage:Q.value.page,"onUpdate:currentPage":a[1]||(a[1]=e=>Q.value.page=e),"page-size":Q.value.limit,"onUpdate:page-size":a[2]||(a[2]=e=>Q.value.limit=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:K.value,onSizeChange:$,onCurrentChange:X},null,8,["currentPage","page-size","total"]),[[w,K.value>0]])])])),_:1}),p(k,{"user-dialog":L.value,"form-data":N.value,onUserHandleSubmitAdd:q,onUserHandleSubmitEdit:G},null,8,["user-dialog","form-data"])])}}});export{K as default};
