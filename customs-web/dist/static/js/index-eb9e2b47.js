import{d as e,u as a,p as l,l as t,r as s,ah as o,a as n,g as r,j as i,y as u,f as d,w as c,ad as p,F as m,h as v,i as f,ai as h,ag as g,X as w,b as y,k as b,Y as k,K as x,E as _,J as C}from"./vendor-78a6dd30.js";import N from"./dialogPermission-c69a84a3.js";import j from"./userDialog-784bca81.js";import{C as U,D as z,E as V,F as B,G as S}from"./index-30d780dc.js";import"./dept-5dd4a664.js";const T={class:"UserContainer scroll-y"},P={class:"head-container m-1 mr-3 rowSS"},I={class:"filter-item"},E=x("查询"),F=x("新增"),K=i("div",{class:"clearfix"},[i("span",null,"用户列表")],-1),D=x("分配角色"),G=x("编辑"),H=x("删除"),A=x("审核通过"),J=x("审核不通过"),L={class:"block columnCC mt-2"},Q=e({setup(e){const Q=a(),R=l(null),X=l(null),Y=l({show:!1}),$=l({}),q=l({page:1,limit:10}),M=[{value:"1",label:"待审核"},{value:"2",label:"审核通过"}];t((()=>{O()}));const O=()=>{Q.dispatch("user/getUserList",q._rawValue).then((e=>{R.value=e.items,X.value=e.total})).catch((e=>{}))},W=()=>{q.page=1,O()},Z=()=>{Y.value={show:!0,title:"新增用户",option:"add"},$.value={realName:"",userName:"",userPassword:"",deptId:"",telephone:"",job:""}};function ee(){U($.value).then((e=>{Y.value.show=!1,_({message:"新增成功！",type:"success"}),O()}))}function ae(){z($.value.id,$.value).then((e=>{Y.value.show=!1,_({message:"更新成功！",type:"success"}),O()}))}const le=l({}),te=e=>{let a=le.value.option;S(a,{roleIds:e}).then((e=>{_({message:"分配成功！",type:"success"}),le.value.show=!1,O()}))};return(e,a)=>{const l=s("el-input"),t=s("el-form-item"),U=s("el-option"),z=s("el-select"),S=s("el-button"),se=s("el-form"),oe=s("el-table-column"),ne=s("el-tag"),re=s("el-button-group"),ie=s("el-table"),ue=s("el-pagination"),de=s("el-card"),ce=o("loading");return n(),r("div",T,[i("div",P,[u(" 查询工具条 "),d(se,{inline:!0,model:q.value,class:"demo-form-inline"},{default:c((()=>[d(t,{label:"姓名"},{default:c((()=>[d(l,{modelValue:q.value.realName,"onUpdate:modelValue":a[0]||(a[0]=e=>q.value.realName=e),placeholder:"姓名",class:"filter-item",onKeyup:p(W,["enter"]),clearable:""},null,8,["modelValue","onKeyup"])])),_:1}),u(' <el-form-item label="用户名">\r\n          <el-input\r\n              v-model="listQuery.userName"\r\n              placeholder="用户名"\r\n              class="filter-item"\r\n              @keyup.enter="handleFilter"\r\n              clearable\r\n          />\r\n        </el-form-item> '),d(t,{label:"审核状态"},{default:c((()=>[d(z,{modelValue:q.value.status,"onUpdate:modelValue":a[1]||(a[1]=e=>q.value.status=e),clearable:"",placeholder:"请选择审核状态"},{default:c((()=>[(n(),r(m,null,v(M,(e=>d(U,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),d(t,null,{default:c((()=>[i("span",I,[d(S,{type:"success",icon:f(h),onClick:W},{default:c((()=>[E])),_:1},8,["icon"]),d(S,{type:"primary",icon:f(g),onClick:Z},{default:c((()=>[F])),_:1},8,["icon"])])])),_:1})])),_:1},8,["model"])]),d(de,{class:"m-1"},{header:c((()=>[K])),default:c((()=>[w((n(),y(ie,{data:R.value,stripe:"",style:{width:"100%"},onSelectionChange:W},{default:c((()=>[d(oe,{fixed:"",type:"index",label:"序号",align:"center",width:"55"},{default:c((e=>[i("span",null,b((q.value.page-1)*q.value.limit+e.$index+1),1)])),_:1}),d(oe,{prop:"realName",label:"姓名",align:"center",width:"100px"}),d(oe,{prop:"userName",label:"账号",align:"center",width:"200px"}),d(oe,{prop:"roles",label:"身份",align:"center","show-overflow-tooltip":!0,width:"300px"},{default:c((e=>[(n(!0),r(m,null,v(e.row.roles,(e=>(n(),r("span",{key:e.id,style:{padding:"0px 4px"}},[d(ne,{size:"small"},{default:c((()=>[x(b(e.roleName),1)])),_:2},1024)])))),128))])),_:1}),d(oe,{prop:"dept.deptName",label:"部门",align:"center","show-overflow-tooltip":!0,width:"300px"},{default:c((()=>[u(' <template #default="scope">\r\n            <span v-for="role in scope.row.roles" :key="role.id" style="padding:0px 4px;">\r\n              <el-tag size="small">{{ role.roleName }}</el-tag>\r\n            </span>\r\n          </template> ')])),_:1}),d(oe,{prop:"telephone",label:"手机号码",align:"center","min-width":"50%"}),d(oe,{prop:"job",label:"职务",align:"center","min-width":"50%"}),d(oe,{label:"操作",align:"center","show-overflow-tooltip":"","min-width":"100%",width:"300px"},{default:c((e=>[d(re,null,{default:c((()=>["2"===e.row.status?(n(),y(S,{key:0,type:"success",onClick:a=>{return l=e.row,void(le.value={show:!0,title:"分配角色",option:l.id});var l}},{default:c((()=>[D])),_:2},1032,["onClick"])):u("v-if",!0),"2"===e.row.status?(n(),y(S,{key:1,type:"warning",onClick:a=>{return l=e.row,Y.value={show:!0,title:"修改用户",option:"edit"},void($.value={id:l.id,realName:l.realName,userName:l.userName,deptId:l.deptId,telephone:l.telephone,job:l.job});var l}},{default:c((()=>[G])),_:2},1032,["onClick"])):u("v-if",!0),"2"===e.row.status?(n(),y(S,{key:2,type:"danger",onClick:a=>{return l=e.row,void C.confirm("此操作将永久删除该用户, 是否继续?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{Q.dispatch("user/deleteUser",l.id).then((e=>{_({message:"删除成功！",type:"success"}),O()})).catch((e=>{}))})).catch((()=>{}));var l}},{default:c((()=>[H])),_:2},1032,["onClick"])):u("v-if",!0),"1"===e.row.status?(n(),y(S,{key:3,type:"success",onClick:a=>{return l=e.row,void C.confirm("确认审核通过该用户吗?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{V(l.id).then((e=>{_({message:"审核成功！",type:"success"}),O()})).catch((e=>{}))})).catch((()=>{}));var l}},{default:c((()=>[A])),_:2},1032,["onClick"])):u("v-if",!0),"1"===e.row.status?(n(),y(S,{key:4,type:"danger",onClick:a=>{return l=e.row,void C.confirm("确认不通过该用户?确认后，该用户信息将被删除，请及时提醒该用户重新注册",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{B(l.id).then((e=>{_({message:"操作成功！",type:"success"}),O()})).catch((e=>{}))})).catch((()=>{}));var l}},{default:c((()=>[J])),_:2},1032,["onClick"])):u("v-if",!0)])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[ce,false]]),i("div",L,[w(d(ue,{currentPage:q.value.page,"onUpdate:currentPage":a[2]||(a[2]=e=>q.value.page=e),"page-size":q.value.limit,"onUpdate:page-size":a[3]||(a[3]=e=>q.value.limit=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:X.value,onSizeChange:W,onCurrentChange:O},null,8,["currentPage","page-size","total"]),[[k,X.value>0]])])])),_:1}),d(j,{"user-dialog":Y.value,"form-data":$.value,onUserHandleSubmitAdd:ee,onUserHandleSubmitEdit:ae},null,8,["user-dialog","form-data"]),d(N,{"permissions-dialog":le.value,ref:"role",onGiveRules:te},null,8,["permissions-dialog"])])}}});export{Q as default};
